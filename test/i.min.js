!function(t){var e=function(t){return"undefined"!=typeof t&&t.hasOwnProperty("id")&&(this.options=t),this};t.I=new e,t.i=function(i){var s=new e(i);return t.I.instances.push(s),s},e.prototype.init=function(t){var e=$("[i-"+t.id+"]"),i={val:""};t.hasOwnProperty("template")&&this.saveTemplate(t.id,t.template),t.hasOwnProperty("stream")&&this.saveStream(t.id,t.stream),t.hasOwnProperty("fromInput")&&(this.fromInput=t.fromInput),t.hasOwnProperty("capture")&&(this.capture=t.capture),t.hasOwnProperty("hooks")&&(this.hooks=t.hooks),this.getStream(t.id),this.getTemplate(t.id),t.hasOwnProperty("startWith")?i=t.startWith:(i={},this.getTokens(this.template).map(function(t){i[t]=""})),this.id=t.id,this.pipes=i,this.setRactive({el:e,template:this.template,data:i}),this.getTokens(this.template).map(this.start.bind(this))},e.prototype.templates={},e.prototype.streams={clock:function(){this.observer.onNext(new Date),setInterval(function(){this.observer.onNext(new Date)}.bind(this),1e3)}},e.prototype.id=null,e.prototype.type="default",e.prototype.pipes={},e.prototype.ractive=null,e.prototype.instances=[],e.prototype.start=function(t){var e=function(t){var e={};this.getTokens(this.template).map(function(i){if(this.hasOwnProperty("capture")&&(t=$(this.capture).val()),this.hasOwnProperty("hooks")&&this.hooks.hasOwnProperty(i)&&(t=this.hooks[i](t)),"string"==typeof t)e[i]=t;else if(t instanceof Date)e[i]=t.toString();else if(i.indexOf(".")>0){var s=t;i.split(".").map(function(t){s=s[t]}),e[i]=s}else e[i]=t[i]}.bind(this)),this.set.call(this,e)};if(this.hasOwnProperty("fromInput"))this.fromInput.map(function(i){if(i.hasOwnProperty("key")||(i.key="val"),i.key===t){var s=Rx.Observable.fromEvent($(i.el),i.method);this.pipes[i.key]=s.subscribe(e.bind(this))}}.bind(this));else if(this.hasOwnProperty("stream")){var i=this.createObservable(this.stream);this.pipes[t]=i.subscribe(e.bind(this))}},e.prototype.set=function(t){this.getTokens(this.template).map(function(e){setTimeout(function(){this.ractive.set(e,t[e])}.bind(this),0)}.bind(this))},e.prototype.asCallback=function(t){return function(t){this.observer.onNext(t)}.bind(t)},e.prototype.setRactive=function(t){this.ractive=new Ractive(t)},e.prototype.getTemplate=function(e){"undefined"==typeof this.template&&(t.I.templates.hasOwnProperty(e)?this.template=t.I.templates[e]:this.template="{{val}}")},e.prototype.saveTemplate=function(e,i){t.I.templates[e]=i},e.prototype.getStream=function(e){"undefined"==typeof this.stream&&(t.I.streams.hasOwnProperty(e)?this.stream=t.I.streams[e]:this.stream=function(){})},e.prototype.saveStream=function(e,i){t.I.streams[e]=i},e.prototype.createObservable=function(t){return Rx.Observable.create(function(e){this.observer=e,t.call(this)}.bind(this))},e.prototype.getTokens=function(t){for(var e,i=[],s=/{{([^}]+)}}/g;e=s.exec(t);)i.push(e[1]);return i}}(window),I.loadScript=function(t,e){var i=document.createElement("script");i.type="text/javascript",i.readyState?i.onreadystatechange=function(){("loaded"==i.readyState||"complete"==i.readyState)&&(i.onreadystatechange=null,e())}:i.onload=function(){e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},I.withRx=function(){I.instances.map(function(t){t.init(t.options)})},I.withRactive=function(){"undefined"==typeof Rx?I.loadScript("https://cdnjs.cloudflare.com/ajax/libs/rxjs/3.1.2/rx.all.min.js",I.withRx):I.withRx()},I.withJQuery=function(){"undefined"==typeof moment?I.loadScript("http://cdn.ractivejs.org/latest/ractive.js",I.withRactive):I.withRactive()},"undefined"==typeof $?I.loadScript("https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js",I.withJQuery):I.withJQuery();