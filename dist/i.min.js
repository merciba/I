function loadScript(t,e){var s=document.createElement("script");s.type="text/javascript",s.readyState?s.onreadystatechange=function(){("loaded"==s.readyState||"complete"==s.readyState)&&(s.onreadystatechange=null,e())}:s.onload=function(){e()},s.src=t,document.getElementsByTagName("head")[0].appendChild(s)}!function(t){var e=function(e){if("undefined"!=typeof e&&e.hasOwnProperty("id")&&"undefined"==typeof t.$){var s=function(){loadScript("https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js",i.bind(this))},i=function(){loadScript("http://cdn.ractivejs.org/latest/ractive.js",n.bind(this))},n=function(){loadScript("https://cdnjs.cloudflare.com/ajax/libs/rxjs/3.1.2/rx.all.min.js",o.bind(this))},o=function(){this.init(e)};loadScript("https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js",s.bind(this))}return this};t.I=new e,t.i=function(t){return new e(t)},e.prototype.init=function(t){var e=$("[i-"+t.id+"]"),s={val:""};t.hasOwnProperty("template")&&this.saveTemplate(t.id,t.template),t.hasOwnProperty("stream")&&this.saveStream(t.id,t.stream),t.hasOwnProperty("fromInput")&&(this.fromInput=t.fromInput),t.hasOwnProperty("capture")&&(this.capture=t.capture),t.hasOwnProperty("hooks")&&(this.hooks=t.hooks),this.getStream(t.id),this.getTemplate(t.id),t.hasOwnProperty("startWith")?s=t.startWith:(s={},this.getTokens(this.template).map(function(t){s[t]=""})),this.name=t.id,this.pipes=s,this.setRactive({el:e,template:this.template,data:s}),this.getTokens(this.template).map(this.start.bind(this))},e.prototype.templates={},e.prototype.streams={clock:function(){this.observer.onNext(moment().format("h:mm:ss a")),setInterval(function(){this.observer.onNext(moment().format("h:mm:ss a"))}.bind(this),1e3)}},e.prototype.id=null,e.prototype.type="default",e.prototype.pipes=null,e.prototype.ractive=null,e.prototype.start=function(t){var e=function(t){var e={};this.getTokens(this.template).map(function(s){this.hasOwnProperty("capture")&&(t=$(this.capture).val()),this.hasOwnProperty("hooks")&&this.hooks.hasOwnProperty(s)&&(t=this.hooks[s](t)),"string"==typeof t?e[s]=t:e[s]=t[s]}.bind(this)),this.set.call(this,e)};if(this.hasOwnProperty("fromInput"))this.fromInput.map(function(s){if(s.hasOwnProperty("key")||(s.key="val"),s.key===t){var i=Rx.Observable.fromEvent($(s.el),s.method);this.pipes[s.key]=i.subscribe(e.bind(this))}}.bind(this));else{var s=this.createObservable(this.stream);this.pipes[t]=s.subscribe(e.bind(this))}},e.prototype.set=function(t){this.getTokens(this.template).map(function(e){setTimeout(function(){this.ractive.set(e,t[e])}.bind(this),0)}.bind(this))},e.prototype.asCallback=function(t){return function(t){this.observer.onNext(t)}.bind(t)},e.prototype.setRactive=function(t){this.ractive=new Ractive(t)},e.prototype.getTemplate=function(e){"undefined"==typeof this.template&&(t.I.templates.hasOwnProperty(e)?this.template=t.I.templates[e]:this.template="{{val}}")},e.prototype.saveTemplate=function(e,s){t.I.templates[e]=s},e.prototype.getStream=function(e){"undefined"==typeof this.stream&&(t.I.streams.hasOwnProperty(e)?this.stream=t.I.streams[e]:this.stream=function(){})},e.prototype.saveStream=function(e,s){t.I.streams[e]=s},e.prototype.createObservable=function(t){return Rx.Observable.create(function(e){this.observer=e,t.call(this)}.bind(this))},e.prototype.getTokens=function(t){for(var e,s=[],i=/{{([^}]+)}}/g;e=i.exec(t);)s.push(e[1]);return s}}(window);